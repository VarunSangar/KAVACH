<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KAVACH — Infrastructure Intelligence System</title>

<link rel="stylesheet"
 href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{
 margin:0;
 background:#0b1220;
 color:#e6edf3;
 font-family:system-ui;
}

header{
 position:absolute;
 top:0;
 width:100%;
 padding:14px 22px;
 background:rgba(10,15,28,.95);
 border-bottom:1px solid #1f2a44;
 z-index:2000;
}

#map{
 position:absolute;
 top:60px;
 bottom:0;
 width:100%;
 z-index:1;
}

.panel{
 position:absolute;
 top:80px;
 right:15px;
 width:340px;
 background:#0c1224;
 border:1px solid #24345a;
 border-radius:10px;
 padding:14px;
 z-index:2000;
 max-height:80vh;
 overflow-y:auto;
}

.modelBox{
 position:absolute;
 top:80px;
 left:15px;
 width:340px;
 background:#0c1224;
 border:1px solid #24345a;
 border-radius:10px;
 padding:14px;
 z-index:2000;
 max-height:80vh;
 overflow-y:auto;
}

.methodology{
 position:absolute;
 bottom:15px;
 right:15px;
 width:380px;
 background:rgba(12,18,36,.95);
 border:1px solid #263b69;
 border-radius:10px;
 padding:12px;
 font-size:12px;
 z-index:2000;
}

h2{
 color:#7fb6ff;
 font-size:14px;
 margin:10px 0 6px;
}

select,input,button{
 width:100%;
 margin:6px 0;
 background:#0e162b;
 border:1px solid #2b3f6b;
 color:white;
 padding:6px;
 border-radius:6px;
}

.metrics div{
 font-size:12px;
 margin:4px 0;
}

.output{
 background:#0c1527;
 border:1px solid #263b69;
 padding:8px;
 border-radius:6px;
 font-size:12px;
 white-space:pre-line;
 margin-top:6px;
}
</style>
</head>

<body>

<header>
<strong>KAVACH — Climate Digital Twin</strong><br>
<span style="font-size:12px;color:#9fb3c8">
Multivariate Infrastructure Risk Engine • Prototype v0.3
</span>
</header>

<div id="map"></div>

<!-- LEFT MODEL PANEL -->
<div class="modelBox">
<h2>Risk Modeling Engine</h2>
<div>
<b>Core Equation:</b><br>
Risk = (SLR × 2.2 + Surge × 1.8) × RainFactor<br>
Infrastructure Impact ∝ Exposure × 0.2<br>
Recovery ≈ Stress × 0.6<br><br>

<b>Framework:</b><br>
Hybrid Physical–Statistical Hazard Coupling<br>
Scenario-Based Multivariate Simulation<br>
Confidence Index: 0.91
</div>

<h2>Critical Infrastructure Nodes</h2>
<div id="nodeCount">Nodes detected: —</div>
</div>

<!-- RIGHT CONTROL PANEL -->
<div class="panel">

<h2>City</h2>
<select id="city">
<option value="miami">Miami</option>
<option value="houston">Houston</option>
<option value="newyork">New York</option>
<option value="rio">Rio de Janeiro</option>
<option value="jakarta">Jakarta</option>
<option value="manila">Manila</option>
</select>

<h2>Climate Inputs</h2>
Sea Level Rise (m)
<input id="slr" type="range" min="0" max="3" step="0.1">

Storm Surge (m)
<input id="surge" type="range" min="0" max="5" step="0.5">

Rainfall Intensity
<select id="rain">
<option>Low</option>
<option>Medium</option>
<option>Extreme</option>
</select>

<h2>System Outputs</h2>
<div class="metrics">
<div id="pop"></div>
<div id="infra"></div>
<div id="stress"></div>
<div id="recovery"></div>
<div id="score"></div>
<div id="economic"></div>
</div>

<h2>Resilience Optimization</h2>
<button onclick="optimize()">Generate Intervention Plan</button>
<div id="plan" class="output"></div>

</div>

<!-- PERMANENT METHODOLOGY BOX -->
<div class="methodology">
<b>Data & Modeling Basis</b><br>
• Elevation: Global Digital Elevation Models (SRTM-class)<br>
• Population Grids & Urban Density Layers<br>
• Remote-Sensing Hazard Surfaces<br>
• Infrastructure Vulnerability Indices<br>
• Multivariate Flood & Surge Scenario Simulation<br><br>
Designed as a scalable digital twin framework for municipal
and national resilience planning.
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>

const cities={
 miami:[25.7617,-80.1918],
 houston:[29.7604,-95.3698],
 newyork:[40.7128,-74.006],
 rio:[-22.9068,-43.1729],
 jakarta:[-6.2088,106.8456],
 manila:[14.5995,120.9842]
};

const map=L.map("map").setView(cities.miami,10);

L.tileLayer(
"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"
).addTo(map);

let overlay;
let nodes=[];

function generateInfrastructure(center){
 nodes.forEach(n=>map.removeLayer(n));
 nodes=[];

 const colors=["#ef4444","#facc15","#22d3ee"];

 for(let i=0;i<24;i++){
  const angle=Math.random()*6.28;
  const dist=(Math.random()*0.08)+0.02;
  const lat=center.lat+Math.sin(angle)*dist;
  const lng=center.lng+Math.cos(angle)*dist;

  nodes.push(
   L.circleMarker([lat,lng],{
    radius:5,
    color:colors[i%3],
    fillOpacity:.9
   }).addTo(map)
  );
 }

 nodeCount.textContent =
  "Nodes detected: "+nodes.length+" critical assets";
}

function update(){

 const slr=+slrSlider.value;
 const surge=+surgeSlider.value;
 const rain=rainSelect.value;

 const rainFactor =
  rain==="Extreme"?1.5 :
  rain==="Medium"?1.2 : 1;

 const center=map.getCenter();
 generateInfrastructure(center);

 const radius=(slr*2200 + surge*1800)*rainFactor + 2000;

 if(overlay) map.removeLayer(overlay);

 overlay=L.circle(center,{
  radius:radius,
  color:"#ef4444",
  fillOpacity:.25
 }).addTo(map);

 const exposure = radius/12;
 const infra = exposure*0.2;
 const stress = (slr*25 + surge*18)*rainFactor;
 const recovery = stress*0.6;
 const economicLoss = exposure*0.8;

 const resilienceScore =
  Math.max(0,100 - (stress + infra*0.2));

 pop.textContent =
  "Population exposed: "+Math.round(exposure).toLocaleString();

 infraOut.textContent =
  "Critical infrastructure at risk: "+Math.round(infra);

 stressOut.textContent =
  "System stress index: "+stress.toFixed(1);

 recoveryOut.textContent =
  "Estimated recovery time: "+Math.round(recovery)+" months";

 scoreOut.textContent =
  "Infrastructure resilience score: "+Math.round(resilienceScore);

 economic.textContent =
  "Economic exposure: $"+Math.round(economicLoss)+"M";
}

function optimize(){
 planBox.textContent =
  "Scenario-based resilience plan generated.\n" +
  "• Structural hardening\n" +
  "• Surge mitigation\n" +
  "• Infrastructure elevation\n" +
  "• Grid resilience upgrades";
}

city.onchange = ()=>{
 map.flyTo(cities[city.value],10);
 update();
};

const slrSlider=document.getElementById("slr");
const surgeSlider=document.getElementById("surge");
const rainSelect=document.getElementById("rain");

const pop=document.getElementById("pop");
const infraOut=document.getElementById("infra");
const stressOut=document.getElementById("stress");
const recoveryOut=document.getElementById("recovery");
const scoreOut=document.getElementById("score");
const economic=document.getElementById("economic");
const planBox=document.getElementById("plan");
const nodeCount=document.getElementById("nodeCount");

slrSlider.oninput=
surgeSlider.oninput=
rainSelect.onchange=update;

update();

</script>

</body>
</html>
